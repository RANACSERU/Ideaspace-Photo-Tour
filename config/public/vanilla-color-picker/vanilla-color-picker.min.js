// ============================================================
//
// Vanilla Color Picker v 0.1.4
//
// http://github.com/miroshko/vanilla-color-picker
//
// This project is licensed under the terms of the MIT license.
//
// ============================================================
!function(e){function t(e,t,i,o){var n=i?"vanilla-color-picker-single-color-picked":""
return"noColor"===e&&o?'<div class="vanilla-color-picker-single-color no-color '+n+'" tabindex="'+t+'" data-color="'+o+'"></div>':'<div class="vanilla-color-picker-single-color '+n+'" tabindex="'+t+'" data-color="'+e+'" style="background-color:'+e+'"></div>'}function i(){if(!document.getElementById("vanilla-color-picker-style")){var t=document.createElement("style")
t.setAttribute("type","text/css"),t.setAttribute("id","vanilla-color-picker-style"),t.innerHTML=l
var i=e.document.head.children[0]
i?e.document.head.insertBefore(t,i):e.document.head.appendChild(t)}}function o(){this.subscribers={},this.on=function(e,t){return this.subscribers[e]=this.subscribers[e]||[],this.subscribers[e].push(t),this},this.emit=function(e){var t=arguments;(this.subscribers[e]||[]).forEach(function(e){e.apply(null,Array.prototype.splice.call(t,1))})}}function n(e,i,n,s,r){o.apply(this),this.targetElem=e,this.elem=null
var l=this
this._initialize=function(){this._createPickerElement(),this._positionPickerElement(),this._addEventListeners()},this.destroy=function(){try{this.elem.parentNode.removeChild(this.elem)}catch(e){}},this._positionPickerElement=function(){var e=this.targetElem.offsetLeft,t=this.targetElem.offsetTop,i=this.targetElem.offsetHeight
if(this.elem.style.left=e+"px",s){this.elem.style.top=t-i-this.elem.offsetHeight+"px"
var o=this.elem.getBoundingClientRect(),n=o.top<0?o.top:0
this.elem.style.top=parseInt(this.elem.style.top,10)-n+"px"
var r=document.querySelector(".medium-editor-toolbar-active")
r&&n&&(this.elem.style.left=r.offsetWidth+5+"px")}else this.elem.style.top=t+i+"px"},this._onFocusLost=function(){setTimeout(function(){l.elem.contains(document.activeElement)?document.activeElement.addEventListener("blur",l._onFocusLost):l.emit("lostFocus")},1)},this._createPickerElement=function(){this.elem=document.createElement("div"),this.elem.classList.add("vanilla-color-picker"),n&&this.elem.classList.add(n)
for(var e=i.indexOf(this.targetElem.dataset.vanillaPickerColor),o=0;o<i.length;o++)this.elem.innerHTML+=t(i[o],o+1,o==e,r)
this.targetElem.parentNode.parentNode.appendChild(this.elem),this.elem.setAttribute("tabindex",1)
var s=e>-1?e:0
this.elem.children[s].focus(),this.elem.children[s].addEventListener("blur",l._onFocusLost)},this._addEventListeners=function(){var e=this
this.elem.addEventListener("click",function(t){t.stopPropagation(),t.target.classList.contains("vanilla-color-picker-single-color")&&e.emit("colorChosen",t.target.dataset.color)}),this.elem.addEventListener("keydown",function(t){t.stopPropagation()
var i=13,o=27,n=t.which||t.keyCode
n==i&&e.emit("colorChosen",t.target.dataset.color),n==o&&e.emit("lostFocus")})},this._initialize()}function s(e){o.apply(this),this.set=this.emit,this.colors=c,this.className="",this.elem=e,this.currentPicker=null,this.positionOnTop=!1
var t=this
this._initialize=function(){this._addEventListeners()},this._addEventListeners=function(){this.elem.addEventListener("click",this.openPicker),this.elem.addEventListener("focus",this.openPicker),this.on("positionOnTop",function(){t.positionOnTop=!0}),this.on("customColors",function(e){if(!e instanceof Array)throw new Error("Colors must be an array")
t.colors=e}),this.on("defaultColor",function(e){t.elem.dataset.vanillaPickerColor||(t._updateElemState(e),t.emit("colorChosen",e,t.elem))}),this.on("noColor",function(e){t.noColor=e}),this.on("className",function(e){t.className=e})},this._updateElemState=function(e){this.elem.dataset.vanillaPickerColor=e,this.elem.value=e},this.destroyPicker=function(){t.currentPicker&&(t.currentPicker.destroy(),t.currentPicker=null,t.emit("pickerClosed"))},this.openPicker=function(){t.currentPicker||(t.currentPicker=new n(t.elem,t.colors,t.className,t.positionOnTop,t.noColor),t.currentPicker.on("colorChosen",function(e){t._updateElemState(e),t.destroyPicker(),t.emit("colorChosen",e,t.elem)}),t.currentPicker.on("lostFocus",function(){t.destroyPicker()}),t.emit("pickerCreated"))},this._initialize()}function r(e,t){return i(),new s(e,t)}var l=".vanilla-color-picker { display: inline-block; position: absolute; width: 204px; padding: 5px; background-color: #393939; border-radius: 5px; box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.3) } .vanilla-color-picker-single-color { display: inline-block; width: 20px; height: 20px; margin: 1px 2px 0; border-radius: 2px; }.no-color { background: linear-gradient(45deg, #ffffff 0%,#ffffff 47%,#ff0f0f 51%,#ff0f0f 51%,#ff0f0f 51%,#ffffff 55%,#ffffff 100%); }",c=["red","yellow","green"]
e.define&&e.define.amd?define([],function(){return r}):e.vanillaColorPicker=r}(this||window)
